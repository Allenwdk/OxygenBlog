# 发布功能使用说明

## 功能介绍

发布页面提供了可视化的文章发布界面，支持两套逻辑：

1. **GitHub Pages 环境**：直接将文章 commit 到 GitHub 仓库
2. **本地开发环境**：将文章保存到本地目录

## 使用方法

### 访问发布页面

1. 在导航栏点击 "发布" 链接
2. 或者直接访问 `/publish` 路径

### 填写文章信息

- **文章标题**：必填，将作为文件名的一部分
- **发布日期**：默认为当前日期，可修改
- **分类**：从预设分类中选择
- **标签**：用逗号分隔多个标签
- **阅读时间**：预估阅读时间（分钟）
- **摘要**：文章摘要，显示在文章卡片上
- **文章内容**：支持 Markdown 格式

### 发布流程

#### GitHub Pages 环境

当网站部署在 GitHub Pages 上时（域名包含 `github.io`）：

1. 系统会自动检测环境
2. 点击"发布文章"按钮
3. 文章将直接 commit 到 GitHub 仓库的 `src/content/blogs/` 目录
4. 需要正确配置 GitHub Actions 环境变量

#### 本地开发环境

在本地开发时：

1. 系统会自动检测环境
2. 点击"发布文章"按钮
3. 文章将保存到本地的 `src/content/blogs/` 目录
4. 无需额外配置

## 环境变量配置

### GitHub Actions 环境变量

在 GitHub Actions 中已经配置了以下 secrets：

- `BLOG_GITHUB_TOKEN`：GitHub 个人访问令牌（需要 repo 权限）
- `BLOG_GITHUB_OWNER`：GitHub 用户名
- `BLOG_GITHUB_REPO`：仓库名称
- `BLOG_GITHUB_BRANCH`：分支名称（默认为 main）

### 本地开发环境变量

如果需要测试 GitHub 集成功能，可以在本地创建 `.env.local` 文件：

```env
BLOG_GITHUB_TOKEN=your_github_token_here
BLOG_GITHUB_OWNER=your_github_username
BLOG_GITHUB_REPO=your_repository_name
BLOG_GITHUB_BRANCH=main
```

## 注意事项

1. **文件名自动生成**：基于文章标题自动生成，特殊字符会被替换为连字符
2. **Markdown 格式**：文章内容需要符合 Markdown 语法
3. **Front Matter**：系统会自动生成 YAML 格式的 front matter
4. **文件冲突**：如果文件已存在，会更新现有文件
5. **权限要求**：GitHub 令牌需要具有仓库的写入权限

## 文章格式示例

发布后的文章格式如下：

```markdown
---
title: 文章标题
date: 2025-01-20
category: 技术
tags: [React, TypeScript, Next.js]
readTime: 5
excerpt: 这是文章摘要
---

这里是 Markdown 格式的文章内容...
```

## 故障排除

### 发布失败

1. 检查网络连接
2. 验证 GitHub 令牌权限
3. 确认仓库配置正确
4. 查看控制台错误信息

### 本地保存失败

1. 检查文件系统权限
2. 确认目录存在且可写
3. 检查文件名是否合法

## 安全提示

- 不要在代码中硬编码 GitHub 令牌
- 使用环境变量存储敏感信息
- 定期更新访问令牌
- 限制令牌的权限范围